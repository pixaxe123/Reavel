<html lang="ko"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>REAVEL</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      transition: background 0.3s, color 0.3s;
    }
    .dark-mode {
      background: #121212;
      color: #f0f0f0;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      position: relative; /* ìì‹ ìš”ì†Œì˜ absolute ìœ„ì¹˜ ê¸°ì¤€ */
      z-index: 1000; /* ì„¤ì • íŒ¨ë„ë³´ë‹¤ ìœ„ì— ìˆë„ë¡ */
    }
    /* REAVEL íƒ€ì´í‹€ ë° ë²„íŠ¼ ê·¸ë£¹ì„ ìœ„í•œ ìƒˆë¡œìš´ flexbox ì»¨í…Œì´ë„ˆ */
    .header-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%; /* ë„ˆë¹„ë¥¼ ê½‰ ì±„ìš°ë„ë¡ ì„¤ì • */
    }
    .header-buttons {
      display: flex;
      gap: 1rem; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
      margin-top: 0.5rem; /* íƒ€ì´í‹€ê³¼ ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
    }
    .reader-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        margin-bottom: 1rem; /* ì œëª©ê³¼ ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
    }
    .reader-header h2 {
        margin: 0.5rem 0;
    }
    .reader-buttons {
        display: flex;
        gap: 1rem;
    }

    .button {
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      font-weight: bold;
    }
    .blog-list, .recommend-list, #searchResults {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      padding: 1rem;
    }
    .blog-card {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
      text-align: center;
      transition: transform 0.2s;
    }
    .blog-card:hover {
      transform: scale(1.03);
    }
    .episode-text {
      padding: 1rem;
      background: white;
      border-radius: 10px;
      white-space: pre-wrap;
    }
    .arrow {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2rem;
      background: white;
      border-radius: 50%;
      padding: 0.5rem 0.8rem;
      box-shadow: 0 0 8px rgba(0,0,0,0.2);
      z-index: 1000;
      cursor: pointer;
    }
    .left-arrow { left: 10px; }
    .right-arrow { right: 10px; }

    .settings-panel {
  display: none;
  position: absolute;
  background: white;
  padding: 1rem;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  z-index: 1001;
}

 
    #readerSettings {
        left: auto;
        right: 1rem;
    }

    .episode-buttons button {
      margin: 0.2rem;
      padding: 0.3rem 0.7rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: white;
      cursor: pointer;
    }

    .episode-buttons .current { background: #007bff; color: white; }
    .episode-buttons .viewed { background: #ccc; color: #333; }
    .episode-buttons .unviewed { background: white; color: black; }

    .dark-mode .blog-card, .dark-mode .episode-text, .dark-mode .settings-panel {
      background: #1e1e1e;
      color: white;
    }
    .history-bottom-bar {
        display: flex;
        justify-content: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
        padding: 1rem;
        background: inherit; /* ë¶€ëª¨ ë°°ê²½ìƒ‰ ìƒì† */
    }
  </style>
</head>
<body>

<div id="homeView" style="display: block;">
  <div class="top-bar">
    <div class="header-group">
      <h2>REAVEL</h2>
      <div class="header-buttons">
        <button class="button" onclick="toggleSettings('home')">ì„¤ì •</button>
        <button class="button" onclick="openHistory()">íˆìŠ¤í† ë¦¬</button>
        <button class="button" onclick="openSearch()">ê²€ìƒ‰</button>
<button class="button" onclick="openLiked()">â¤ï¸ ì¢‹ì•„ìš”</button>
      </div>
    </div>
  </div>
  <div id="homeSettings" class="settings-panel">
    <label><input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()"> ë‹¤í¬ëª¨ë“œ</label>
  </div>

  <h3 style="text-align:center;">ì´ê±´ ì–´ë– ì„¸ìš”?</h3>
  <div class="recommend-list" id="recommendList"><div class="blog-card">ê¸°ì‚¬ì¸ë° ê±°ì§€ì…ë‹ˆë‹¤ë§Œ?</div><div class="blog-card">82ì„¸ ê¹€ì¶˜ë°° ë§ˆíƒ‘ì£¼ê°€ ë˜ë‹¤</div><div class="blog-card">ì‚¬ëŒì´ ë˜ê³ íŒŒ</div></div>

  <h3 style="text-align:center;">ëª¨ë‘ ë‹¤ ëª¨ì•˜ì–´ìš”!</h3>
  <div class="blog-list" id="blogList"><div class="blog-card">ê¸°ì‚¬ì¸ë° ê±°ì§€ì…ë‹ˆë‹¤ë§Œ?</div><div class="blog-card">82ì„¸ ê¹€ì¶˜ë°° ë§ˆíƒ‘ì£¼ê°€ ë˜ë‹¤</div><div class="blog-card">ì‚¬ëŒì´ ë˜ê³ íŒŒ</div></div>
</div>

<div id="searchView" style="display:none;">
  <div class="top-bar">
    <button class="button" onclick="goHome()">â† í™ˆ</button>
    <input id="searchInput" placeholder="ê²€ìƒ‰..." oninput="performSearch()" style="flex:1; margin-left:1rem; padding:0.5rem; font-size:1rem;">
  </div>
  <div class="blog-list" id="searchResults"></div>
</div>

<div id="readerView" style="display:none;">
  <div class="top-bar">
    <div class="reader-header">
      <h2 id="readerTitle">ë¸”ë¡œê·¸ ì œëª©</h2>
      <div class="reader-buttons">
        <button class="button" onclick="toggleSettings('reader')">ì„¤ì •</button>
        <button class="button" onclick="toggleEpisodeList()"> íšŒì°¨ ì„ íƒ</button>
        <button class="button" onclick="goHome()">â† í™ˆ</button>
<button id="likeButton" class="button" onclick="toggleLike()">ğŸ¤</button>
      </div>
    </div>
  </div>
  <div id="readerSettings" class="settings-panel">
    <label>í°íŠ¸ í¬ê¸°</label>
    <input type="range" min="12" max="36" value="16" id="fontSlider" oninput="setFontSize(this.value)">
    <input type="number" min="12" max="36" value="16" id="fontInput" oninput="setFontSize(this.value)">
  </div>
  <div id="episodeList" class="episode-buttons" style="padding:1rem; display:none;"></div>
  <div class="arrow left-arrow" id="prevEpisodeArrow" onclick="prevEpisode()" style="display: none;">â†</div>
  <div class="arrow right-arrow" id="nextEpisodeArrow" onclick="nextEpisode()" style="display: none;">â†’</div>
  <div id="episodeContent" class="episode-text" style="font-size:16px;"></div>
</div>

<div id="historyView" style="display:none;">
  <div class="top-bar">
    <button class="button" onclick="goHome()">â† í™ˆ</button>
    <h2>íˆìŠ¤í† ë¦¬</h2>
    <div></div>
  </div>
  <div class="blog-list" id="historyList"></div>
  <div class="history-bottom-bar">
      <button class="button" onclick="clearHistory()">íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”</button>
  </div>
</div>

 <div id="likedView" style="display:none;">
  <div class="top-bar">
    <button class="button" onclick="goHome()">â† í™ˆ</button>
    <h2>â¤ï¸ ì¢‹ì•„ìš”</h2>
    <div></div>
  </div>
  <div class="blog-list" id="likedList"></div>
</div>
 
 


<script>
  const blogTitles = ["ê¸°ì‚¬ì¸ë° ê±°ì§€ì…ë‹ˆë‹¤ë§Œ?", "82ì„¸ ê¹€ì¶˜ë°° ë§ˆíƒ‘ì£¼ê°€ ë˜ë‹¤", "ì‚¬ëŒì´ ë˜ê³ íŒŒ"];
  const blogs = [
    [
      `ë‚˜ëŠ” íƒœìƒë¶€í„° ìš´ì´ ì—†ì—ˆë‹¤.

ì—„ë§ˆì™€ ì•„ë¹ ê°€ ê°ê° í•œ ë¶„ ë°–ì— ì—†ëŠ” ë¶ˆìš°í•œ ê°€ì •ì—ì„œ íƒœì–´ë‚¬ê¸° ë•Œë¬¸ì´ì˜€ë‹¤.

í•˜ì§€ë§Œ ë‚˜ëŠ” ê¸°ì‚¬ê°€ ë  ê²ƒì´ë¼ëŠ” ìˆ­ê³ í•œ ê¿ˆì´ ìˆì—ˆë‹¤!

ë‚˜ì˜ ì‚¶ì„ ë§ì¹œ ì‹ ì´ë¼ëŠ” ì‘ìì—ê²Œ ëŒ€ì í•  ìˆ­ê³ í•œ ê¸°ì‚¬ì˜ ì •ì‹ ì„ ë§ì´ë‹¤!

ë‚˜ëŠ” ë‚˜ì˜ 10ë²ˆì§¸ ìƒì¼ ì´í›„ë¶€í„° ê³„ì† ê²€ìˆ ì„ ì—°ë§ˆí•˜ì—¬ ë§ˆì¹¨ë‚´
ìƒê¸‰ ê¸°ì‚¬ë¡œ ìŠ¹ê²©í•˜ì˜€ë‹¤.


ë‚˜ì˜ ì´ë¦„ì€ ê¹€ì² ìˆ˜.


ë‚˜ ê¹€ì² ìˆ˜ëŠ” ì´ì œ ê¸°ì‚¬ë„ì˜ ì´ë¦„ìœ¼ë¡œ ë¬´ëŠ¥í•œ ì‹ ì„ ì²™ê²°í•˜ëŸ¬ ëŒ€ì¥ì •ì„ ë– ë‚œë‹¤!

...

ë¼ê³  ë§ì€ í–ˆì§€ë§Œ... ì†”ì§íˆ ê³„íšë„ ì—†ê³ .. ì«„ë¦°ë‹¤.

í•˜ì§€ë§Œ ê±±ì •í•˜ì§€ ë§ˆë¼! ìˆ™ë ¨ëœ ê¸°ì‚¬ì˜ ë¬´ê¸°, ê²Œí‹€ë§ ê±´ì„ ì§€ì¸ì´ êµ¬í•´ë‹¤ ì¤€ë‹¤ê³  í–ˆìœ¼ë‹ˆ ë§ì´ë‹¤!

ê·¸ê²ƒë§Œ ìˆë‹¤ë©´.. ë‚˜ë„ ì„¸ê³„ ìµœê³ ê°€ ë  ìˆ˜ ìˆë‹¤!!

ê·¸ëŸ¬ë‚˜ ì–´ë–¤ ì—°ìœ ì—ì„œ ì¸ì§€, ê·¸ ì§€ì¸ì€ ëª‡ ë‹¬ì§¸ ë‹µì´ ì—†ë‹¤... ë¶ˆì•ˆì´ ì—„ìŠµí•œë‹¤..

ì§€ì¸ì˜ ì§‘ì— ì°¾ì•„ê°€ ë³´ì!

ì§€ì¸ì˜ ì§‘ ë¬¸ì„ ë¶€ìˆ˜ê³  ì¹¨íˆ¬í•˜ì˜€ìœ¼ë‚˜, ì§€ì¸ì€ ì´ë¯¸ ì‚¬ë¼ì§„ì§€ ì˜¤ë˜ì´ê³ .. 

í•˜ë‚˜ì˜ ë´‰íˆ¬ ë¿ì´ì—ˆë‹¤.

ë–¨ë¦¬ëŠ” ì†. íë¥´ëŠ” ë•€. ë´‰íˆ¬ë¥¼ ì—´ì–´ë³¸ë‹¤. `,
      `ì§€ì¸ë§Œ ë¯¿ì—ˆë‹¤. 

ë¯¿ì—ˆì—ˆë‹¤.

ì´ì   í™”ë§Œ ë‚¨ì•˜ë‹¤,

ì•„ë‹ˆ í™”ë„ ì—†ë‹¤.

ì§€ì¸ì´ ë‚´ ëˆì„ ê°€ì§€ê³  íŠˆ ë•Œ ê°™ì´ ê°€ì ¸ê°”ë‚˜ ë³´ë‹¤.

â€¦

ì´ì œ ëª©í‘œê°€ ë°”ë€ ê²ƒ ê°™ë‹¤.

ë‚´ ëˆì„ ê°€ì§€ê³  íŠ„ ê·¸ ê°œìì‹ì„ ì¡ì•„ ì¡±ì¹  ê²ƒì´ë‹¤.

ì‹ ? ì‹ ì€ ì—†ë‹¤.

í•˜ì§€ë§Œ ê·¸ ìì‹ì€ ìˆì§€â€¦

ì¹¼ì„ ê°„ë‹¤.

ë‚ ì¹´ë¡­ë‹¤.

ë‚˜ ê¹€ì² ìˆ˜ ì ˆ ë•Œ êµ´í•˜ì§€ ì•ŠëŠ”ë‹¤.

ê·¸ìì‹ì˜ ìœ„ì¹˜ëŠ” ë¶„ëª…í•˜ë‹¤!

ì–´ë–»ê²Œ í™•ì‹ í•˜ëƒê³ ?


í›—â€¦


ë‚˜ëŠ” ê·¸ìì—ê²Œ ë¬¼ê±´ìœ¼ë¡œ ê°’ì„ ì¹˜ë£¨ì—ˆë‹¤.

ê·¸ì •ë„ ë¬¼ê±´ì€ ìˆ˜ë„ì—ì„œë§Œ íŒ” ìˆ˜ ìˆì„ ê²ƒì´ê³ â€¦

ê·¸ë ‡ë‹¤ëŠ”ê±´ ê·¸ìëŠ” ìˆ˜ë„ì— ìˆì„ ê²ƒì´ë¼ëŠ” ê²ƒì´ë‹¤!

í›„í›„í›„â€¦

ííí.. 

ìœ¼í•˜í•˜í•˜í•˜!!!

ê·¸ë‚  ì£¼ë¯¼ë“¤ì€ ì•…ë§ˆì˜ ì†Œë¦¬ë¥¼ ë“¤ì—ˆë‹¤.`
    ],
    [
      `ì´ ì´ì•¼ê¸°ëŠ” í‰ë²”í•˜ê³  í‰ë²”í•œ ëŒ€í•œë¯¼êµ­ì˜ í•œ ë…¸ì¸ ê¹€ì¶˜ë°°ì”¨ì—ê²Œì„œ ì‹œì‘ëœë‹¤.

â€œì—ê³ ê³ .. í—ˆë¦¬ì•¼..â€

ì™¸ì¶œì„ ë§ˆì¹˜ê³  ë…¸ì–‘ì›ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ì¤‘ì´ì—ˆë˜ ê¹€ì¶˜ë°°.

ë™ë…„ë°°ë“¤ì¤‘ ê°€ì¥ íŒ”íŒ”í–ˆë˜ ê·¸ì˜€ê³  ì˜¤ëŠ˜ë„ ìì‹ ë³´ë‹¤ 10ì‚´ì •ë„ ì–´ë ¤ë³´ì´ëŠ” ì´ë“¤ê³¼ í•¨ê»˜ íŒŒí¬ê³¨í”„ë¥¼ ì¦ê¸°ë‹¤ê°€ ë…¸ì¸ì •ìœ¼ë¡œ ê°€ëŠ”ì¤‘ì´ì—ˆë‹¤.

ê°„ë§Œì— ë¼ìš´ë“œê°€ ì˜ í’€ë ¤ì„œì¸ì§€ ë°œì´ ê°€ë³ë‹¤.

ì˜¨ëª¸ì´ ë¶• ë¶• ëœ¨ëŠ” ê²ƒ ê°™ê³ 

ë°œë°‘ì— ë‹¿ëŠ” ëŠë‚Œì´ ì—†â€¦? ë‹¤?

ì¿µâ€¦!

82ì„¸ ê¹€ì¶˜ë°°ì˜ ë§ˆì§€ë§‰. ì•„ë‹ˆ

â€œëŒ€í•œë¯¼êµ­ì—ì„œì˜ ë§ˆì§€ë§‰â€

ì´ì—ˆë‹¤. `,
      `â€œìœ¼ìœ¼.. ë¨¸ë¦¬ì•¼ ì—ê³ ê³ .. ì‚´ì•„ëŠ” ìˆêµ¬ë¨¼â€¦â€

..?

â€œì‚´ì•„ëŠ” ìˆë‚˜?â€

ëˆˆì•ì—ëŠ” ì›¬ ìˆ²ì´ í¼ì³ì ¸ ìˆë‹¤.

â€œë­ì—¬â€¦? â€

ë’¤ë¥¼ ëŒì•„ë³´ì§€ë§Œ ë’¤ë„ ì—­ì‹œ ìˆ².

â€œì–´ì–´..?â€

â€œì—¬ê¸°ëŠ” ì–´ë””ì—¬â€¦?â€

ì €ë²… ì €ë²…

â€œì—¬ë³´ìŠˆ!! ê±°ê¸° ëˆ„êµ¬ ì—†ì†Œ..?â€

í’€ìˆ²ì´ ì¡°ê¸ˆ í”ë“¤ë¦¬ë”ë‹ˆ ëˆˆì•ì— ì›¬ ì´ìƒí•œ.. ì•„ë‹ˆ ì†ë…€ê°€ í•¸ë“œí°ìœ¼ë¡œ ë³´ë˜ ì›¹..?íˆ°? ì—ì„œ ë§ì´ ë³´ì•˜ë˜ ë³µì¥ì˜ ë‚¨ìê°€ ë‚˜ì˜¨ë‹¤.

â€œëˆ„êµ¬..? ì—¬ê¸´ ì–´ë–»ê²Œâ€¦?â€

ë™ë°©ì˜ˆì˜ì§€êµ­ì—ì„œ 82ë…„ë™ì•ˆ ì‚´ì•„ì˜¨ ê¹€ì¶˜ë°°ì—ê²Œ ì Šì€ ë‚¨ì„±ì˜ ë°˜ë§ì€ ìƒìƒë„ í•˜ì§€ ëª»í•  ê²ƒì´ì—ˆë‹¤.

â€œì•¼! ì„ë§ˆ! ë„ˆëŠ” ëˆ„êµ°ë° ì–´ë¥¸í•œí…Œ ì˜ˆì˜ë„ ì—†ì´ ë§ì•¼! ì–´! ë„ˆ ëª‡ì‚´ì´ì•¼?!â€


ë¶ˆì˜ ë§ˆíƒ‘ì—ì„œ 30ë…„ ë™ì•ˆ ì—°êµ¬ì— ë§¤ì§„í•˜ë‹¤ ì ì‹œ ì‚°ì±…ì„ ë‚˜ì˜¨ ìˆ˜ì„ ë§ˆë²•ì‚¬ ì°¨ë¥´ì•„ì—ê²Œ í˜¸í†µì†Œë¦¬ëŠ” ìƒìƒë„ í•˜ì§€ ëª»í•  ê²ƒì´ì—ˆë‹¤.

â€œì•„â€¦â€

ì¶˜ë°°ì”¨ì˜ ëˆˆì¹ì´ ê¿ˆí‹€ê±°ë¦°ë‹¤.

â€œì•„? ì•„ì•„? ì§€ê¸ˆ í•œìˆ¨ì‰°ê²¨? ë‚´ ì•ì—ì„œ? í•œìˆ¨? í•˜ì•„ì•„ì•ˆ ìˆ˜ì›€..?â€

â€œì—ì‰ ì¯”ì¯”.. ìš”ì¦˜ ê²ƒë“¤ì€ ì´ë¦¬ ì˜ˆì˜ë¥¼ ì„¤ë íƒ•ì—ë‹¤ê°€ ë©´ë„£ê³  ë°¥ë„£ê³  ê¹ë‘ê¸° êµ­ë¬¼ ë„£ì„ë•Œ ê°™ì´ ë„£ì–´ì„œ ì¢ìˆ˜ì‹œëŠ” ê±´ê°€?â€

ì°¨ë¥´ì•„ëŠ” ë¶ˆì˜ ë§ˆë²•ì„ ë‹¤ë£¨ê¸°ì— ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ë³´ëŠ” ëŠ¥ë ¥ë”°ìœ„ëŠ” ì—†ë‹¤.

í•˜ì§€ë§Œ ë³´ì´ëŠ” ê²ƒ ê°™ë‹¤.

ë§¤ìš° í° ë¶ˆì´ë‹¤. 

ìì‹ ì€ í•œë²ˆë„ ê²ªì–´ë³´ì§€ ëª»í•œ, ê²ªê¸°ë„ ì‹«ì€â€¦

ã…ˆX í°ë¶ˆ!!!!!!!!

ë‘ ëˆˆì´ í”ë“¤ë¦¬ê³  ë˜ í”ë“¤ë¦°ë‹¤.

ë•€ì´ ì–¼êµ´ì„ íƒ€ê³  ë‚´ë ¤ì˜¨ë‹¤.

ë§ˆë¥¸ì¹¨ì„ ì‚¼í‚¨â€¦

ì ê¹ë§Œ.. ìì•„ì•”ê¹ë§Œâ€¦

ë¶ˆâ€¦?

ì•„ì£¼í°â€¦?

ê²ªì–´ë³´ì§€ ëª»í•œâ€¦?

ì ê¹ë§Œâ€¦

ì‘â€¦?

ì´ê±° í•˜ë‚˜ëŠ” í™•ì‹¤í•˜ë‹¤.

ìˆ˜ì„ ë§ˆë²•ì‚¬ ì°¨ë¥´ì•„ ì•ì—ëŠ” ì§€ìƒ ìµœëŒ€ ë¶ˆì˜ ë§ˆë²•ì‚¬ê°€ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì´ë‹¤. `
    ],
    [
      `â€œì™œ ì‚¬ëŒìœ¼ë¡œ íƒœì–´ë‚œê±°ì§€â€¦â€

ë‚´ ë§ˆì§€ë§‰ ë§ì´ì—ˆë‹¤.

ì‚¬ëŒì´ ì•„ë‹ˆì—ˆìœ¼ë©´ ê±°ì§€ê°™ì€ ê³µë¶€ë„ ì·¨ì—…ë„ ê±±ì •ë„ ì—†ì–´ë„ ë  ê²ƒ ì´ì—ˆìœ¼ë‹ˆê¹Œ.

â€¦ ì´ê²Œ ëì¸ê°€..?

í—ˆë¬´í•˜ë‹¤â€¦

ë‹¤ìŒìƒì—ëŠ” ì‚¬ëŒì´ ì•„ë‹ˆì—ˆìœ¼ë©´â€¦

íŒŒì•„ì•—!

ìŒ..? ì—¬ê¸´.. ì–´ë””..? `
    ]
  ];

  let currentBlog = 0;
  let currentEpisode = 0;

  let viewed = {};
  let lastReadEpisode = {};

  const views = {
  home: document.getElementById("homeView"),
  search: document.getElementById("searchView"),
  reader: document.getElementById("readerView"),
  history: document.getElementById("historyView"),
  liked: document.getElementById("likedView") 
};

  const prevEpisodeArrow = document.getElementById("prevEpisodeArrow");
  const nextEpisodeArrow = document.getElementById("nextEpisodeArrow");

  function loadDataFromLocalStorage() {
      const savedViewed = localStorage.getItem('viewed');
      if (savedViewed) {
          const parsedViewed = JSON.parse(savedViewed);
          for (const key in parsedViewed) {
              viewed[key] = new Set(parsedViewed[key]);
          }
      }

      const savedLastRead = localStorage.getItem('lastReadEpisode');
      if (savedLastRead) {
          lastReadEpisode = JSON.parse(savedLastRead);
      }
  }

  function saveViewedToLocalStorage() {
      const plainViewed = {};
      for (const key in viewed) {
          plainViewed[key] = Array.from(viewed[key]);
      }
      localStorage.setItem('viewed', JSON.stringify(plainViewed));
  }

  function saveLastReadEpisodeToLocalStorage() {
      localStorage.setItem('lastReadEpisode', JSON.stringify(lastReadEpisode));
  }

  function show(view) {
    // ëª¨ë“  ë·°ë¥¼ ìˆ¨ê¸°ê¸° ì „ì—, í˜„ì¬ ë³´ì´ëŠ” ë·°ê°€ homeViewê°€ ì•„ë‹ˆë¼ë©´ ìˆ¨ê²¨ì¤ë‹ˆë‹¤.
    // ì´ë ‡ê²Œ í•˜ë©´ ì´ˆê¸° ë¡œë”© ì‹œ homeViewê°€ ê¹œë¹¡ì´ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    Object.values(views).forEach(v => {
        if (v.id !== view + 'View') { // í˜„ì¬ ë³´ì—¬ì¤„ ë·°ê°€ ì•„ë‹ˆë¼ë©´
            v.style.display = "none";
        }
    });
    views[view].style.display = "block";

    // ë·° ì „í™˜ ì‹œ í•­ìƒ ì„¤ì • íŒ¨ë„ê³¼ íšŒì°¨ ì„ íƒ íŒ¨ë„ ë‹«ê¸°
    hideAllSettings();

    if (view !== 'reader') { // ë¦¬ë” ë·°ê°€ ì•„ë‹ ë•ŒëŠ” í™”ì‚´í‘œ ìˆ¨ê¹€
        prevEpisodeArrow.style.display = 'none';
        nextEpisodeArrow.style.display = 'none';
    }
  }

  function goHome() { 
      show("home"); 
  }

  function openSearch() {
    show("search");
    document.getElementById("searchInput").value = "";
    performSearch();
  }

  function performSearch() {
    const q = document.getElementById("searchInput").value.toLowerCase();
    const result = document.getElementById("searchResults");
    result.innerHTML = "";
    blogTitles.forEach((t, i) => {
      if (t.toLowerCase().includes(q)) {
        const el = document.createElement("div");
        el.className = "blog-card";
        el.textContent = t;
        el.onclick = () => openReader(i);
        result.appendChild(el);
      }
    });
  }

  function openReader(index) {
    currentBlog = index;
    currentEpisode = lastReadEpisode[currentBlog] !== undefined ? lastReadEpisode[currentBlog] : 0;
    
    renderEpisode();
    show("reader");
    document.getElementById("readerTitle").textContent = blogTitles[index];

updateLikeButton(); 

    updateEpisodeButtons();
    updateNavigationArrows();

  }

  function renderEpisode() {
    const text = blogs[currentBlog][currentEpisode];
    document.getElementById("episodeContent").innerHTML = `<h3>${currentEpisode + 1}í™”</h3><div>${text}</div>`;
    markViewed(currentBlog, currentEpisode);
    updateLastReadEpisode(currentBlog, currentEpisode);
    updateNavigationArrows();

window.scrollTo(0, 0);  

  }

  function nextEpisode() {
    if (currentEpisode < blogs[currentBlog].length - 1) {
      currentEpisode++;
      renderEpisode();
      updateEpisodeButtons();
    }
  }

  function prevEpisode() {
    if (currentEpisode > 0) {
      currentEpisode--;
      renderEpisode();
      updateEpisodeButtons();
    }
  }

  function updateNavigationArrows() {
      prevEpisodeArrow.style.display = (currentEpisode > 0) ? 'block' : 'none';
      nextEpisodeArrow.style.display = (currentEpisode < blogs[currentBlog].length - 1) ? 'block' : 'none';
  }

  function updateEpisodeButtons() {
    const list = document.getElementById("episodeList");
    list.innerHTML = "";
    blogs[currentBlog].forEach((_, i) => {
      const btn = document.createElement("button");
      btn.textContent = i + 1;
      if (i === currentEpisode) btn.className = "current";
      else if ((viewed[currentBlog] || new Set()).has(i)) btn.className = "viewed";
      else btn.className = "unviewed";
      btn.onclick = () => {
        currentEpisode = i;
        renderEpisode();
        updateEpisodeButtons();
        list.style.display = "none";
      };
      list.appendChild(btn);
    });
  }

  function toggleEpisodeList() {
  const el = document.getElementById("episodeList");

  // ì„¤ì • íŒ¨ë„ ë‹«ê¸° ë¨¼ì €
  hideAllSettings();

  if (el.style.display === "block") {
    el.style.display = "none";
  } else {
    updateEpisodeButtons(); // íšŒì°¨ ë²„íŠ¼ì´ ë³´ì´ë„ë¡ ë§¤ë²ˆ ìƒì„±
    el.style.display = "block";
  }
}

  function setFontSize(val) {
    document.getElementById("fontSlider").value = val;
    document.getElementById("fontInput").value = val;
    document.getElementById("episodeContent").style.fontSize = val + "px";
  }

function toggleSettings(context) {
  const target = context + 'Settings';
  const panel = document.getElementById(target);

  // í˜„ì¬ ì—´ë ¤ìˆëŠ” íŒ¨ë„ì´ ìˆë‹¤ë©´ ë‹«ê¸°
  ['homeSettings', 'readerSettings', 'episodeList'].forEach(id => {
      const el = document.getElementById(id);
      if (el && el.id !== target && el.style.display === 'block') {
          el.style.display = 'none';
      }
  });

  // ë²„íŠ¼ ìœ„ì¹˜ ë°”ë¡œ ì•„ë˜ë¡œ ì„¤ì •ì°½ ìœ„ì¹˜ ë§ì¶”ê¸°
  const button = document.querySelector(`button[onclick="toggleSettings('${context}')"]`);
  if (button) {
    const rect = button.getBoundingClientRect();
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    panel.style.position = 'absolute';
    panel.style.left = rect.left + 'px';
    panel.style.top = rect.bottom + scrollTop + 'px';
  }

  // ì„¤ì •ì°½ í† ê¸€
  panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
}

  function hideAllSettings() {
    document.getElementById('homeSettings').style.display = 'none';
    document.getElementById('readerSettings').style.display = 'none';
    document.getElementById('episodeList').style.display = 'none'; // íšŒì°¨ ì„ íƒ íŒ¨ë„ë„ ë‹«ê¸°
  }

  function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
  }

  function markViewed(b, e) {
    if (!viewed[b]) viewed[b] = new Set();
    viewed[b].add(e);
    saveViewedToLocalStorage();
    
    const historyKey = 'history';
    const savedBlogsInHistory = JSON.parse(localStorage.getItem(historyKey) || '[]');
    if (!savedBlogsInHistory.includes(b)) {
        savedBlogsInHistory.push(b);
        localStorage.setItem(historyKey, JSON.stringify(savedBlogsInHistory));
    }
  }

  function updateLastReadEpisode(blogIndex, episodeIndex) {
      lastReadEpisode[blogIndex] = episodeIndex;
      saveLastReadEpisodeToLocalStorage();
  }

  function openHistory() {
    show("history");
    const list = document.getElementById("historyList");
    list.innerHTML = "";
    const saved = JSON.parse(localStorage.getItem("history") || "[]");
    saved.forEach(i => {
      const el = document.createElement("div");
      el.className = "blog-card";
      el.textContent = blogTitles[i];
      el.onclick = () => openReader(i);
      list.appendChild(el);
    });
  }

  function clearHistory() {
      if (confirm("ëª¨ë“  íˆìŠ¤í† ë¦¬ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
          localStorage.removeItem('history');
          localStorage.removeItem('viewed');
          localStorage.removeItem('lastReadEpisode');

          viewed = {};
          lastReadEpisode = {};

          openHistory();
          alert("íˆìŠ¤í† ë¦¬ ê¸°ë¡ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }
  }

  function renderHomeLists() {
    const blogList = document.getElementById("blogList");
    const recommendList = document.getElementById("recommendList");
    blogList.innerHTML = "";
    recommendList.innerHTML = "";

    blogTitles.forEach((t, i) => {
      const el = document.createElement("div");
      el.className = "blog-card";
      el.textContent = t;
      el.onclick = () => openReader(i);
      blogList.appendChild(el);
    });

    const shuffled = [...blogTitles.keys()].sort(() => 0.5 - Math.random()).slice(0, 6);
    shuffled.forEach(i => {
      const el = document.createElement("div");
      el.className = "blog-card";
      el.textContent = blogTitles[i];
      el.onclick = () => openReader(i);
      recommendList.appendChild(el);
    });
  }

  // DOMContentLoaded ì‚¬ìš©: HTMLì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
  // window.onload ëŒ€ì‹  ì‚¬ìš©í•˜ë©´ ë” ë¹ ë¥´ê²Œ ë¡œë”©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  document.addEventListener('DOMContentLoaded', () => {
      loadDataFromLocalStorage();
loadLikesFromLocalStorage();
      renderHomeLists();
      // ì´ˆê¸°ì—ëŠ” homeViewë§Œ ë³´ì´ê³  ë‹¤ë¥¸ ë·°ë“¤ì€ ìˆ¨ê²¨ì ¸ ìˆì–´ì•¼ í•¨
      // ì´ì „ì— display:noneìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë¯€ë¡œ, homeViewë§Œ 'block'ìœ¼ë¡œ ëª…ì‹œ
      document.getElementById('homeView').style.display = 'block';
      document.getElementById('searchView').style.display = 'none';
      document.getElementById('readerView').style.display = 'none';
      document.getElementById('historyView').style.display = 'none';

      // ì´ˆê¸° ë¡œë“œ ì‹œ í™”ì‚´í‘œëŠ” ìˆ¨ê²¨ì ¸ ìˆì–´ì•¼ í•¨
      prevEpisodeArrow.style.display = 'none';
      nextEpisodeArrow.style.display = 'none';
  });

let likedBlogs = [];

function loadLikesFromLocalStorage() {
  const saved = localStorage.getItem("likedBlogs");
  if (saved) likedBlogs = JSON.parse(saved);
}

function saveLikesToLocalStorage() {
  localStorage.setItem("likedBlogs", JSON.stringify(likedBlogs));
}

function isLiked(index) {
  return likedBlogs.includes(index);
}

function toggleLike() {
  if (isLiked(currentBlog)) {
    likedBlogs = likedBlogs.filter(i => i !== currentBlog);
  } else {
    likedBlogs.push(currentBlog);
  }
  saveLikesToLocalStorage();
  updateLikeButton();
}

function updateLikeButton() {
  const btn = document.getElementById("likeButton");
  if (!btn) return;
  btn.textContent = isLiked(currentBlog) ? "â¤ï¸" : "ğŸ¤";
}

function showLiked() {
  show("home");
  const blogList = document.getElementById("blogList");
  blogList.innerHTML = "";

  likedBlogs.forEach(i => {
    const el = document.createElement("div");
    el.className = "blog-card";
    el.textContent = blogTitles[i];
    el.onclick = () => openReader(i);
    blogList.appendChild(el);
  });
}

function openLiked() {
  show("liked");

  const list = document.getElementById("likedList");
  list.innerHTML = "";

  if (likedBlogs.length === 0) {
    const msg = document.createElement("p");
    msg.textContent = "ì¢‹ì•„ìš”í•œ ë¸”ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.";
    msg.style.textAlign = "center";
    list.appendChild(msg);
    return;
  }

  likedBlogs.forEach(i => {
    const el = document.createElement("div");
    el.className = "blog-card";
    el.textContent = blogTitles[i];
    el.onclick = () => openReader(i);
    list.appendChild(el);
  });
}

</script>


</body></html>
